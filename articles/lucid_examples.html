<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lucid printing of floating-point vectors • lucid</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lucid printing of floating-point vectors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lucid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lucid_examples.html">Lucid printing of floating-point vectors</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kwstat/lucid/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Lucid printing of floating-point vectors</h1>
                        <h4 data-toc-skip class="author">Kevin
Wright</h4>
            
            <h4 data-toc-skip class="date">2024-07-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kwstat/lucid/blob/main/vignettes/lucid_examples.Rmd" class="external-link"><code>vignettes/lucid_examples.Rmd</code></a></small>
      <div class="d-none name"><code>lucid_examples.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://yihui.org/knitr/" class="external-link">"knitr"</a></span><span class="op">)</span></span>
<span>    <span class="va">opts_chunk</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>fig.align<span class="op">=</span><span class="st">"center"</span>, fig.width<span class="op">=</span><span class="fl">6</span>, fig.height<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">90</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h3>
<p><span class="citation">Farquhar and Farquhar (1891)</span> provide a
humorous quote about tables:</p>
<blockquote>
<p>The graphic method has considerable superiority for the exposition of
statistical facts over the tabular. A heavy bank of figures is
grievously wearisome to the eye, and the popular mind is as incapable of
drawing any useful lessons from it as of extracting sunbeams from
cucumbers.</p>
</blockquote>
<p>The <code>lucid</code> package intends to make your life easier by
helping you extract information from tables. The package has functions
for printing vectors and tables of floating-point numbers in a
human-friendly format. An application is presented for printing of
variance components from mixed models.</p>
</div>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Numerical output from R is often in scientific notation, which can
make it difficult to quickly glance at numbers and understand the
relative sizes of the numbers. This not a new phenomenon. Before R had
been created, <span class="citation">Finney (1988)</span> had this to
say about numerical output:</p>
<blockquote>
<p>Certainly, in initiating analyses by standard software or in writing
one’s own software, the aim should be to have output that is easy to
read and easily intelligible to others. … Especially undesirable is the
so-called ‘scientific notation’ for numbers in which every number is
shown as a value between 0.0 and 1.0 with a power of 10 by which it must
be multiplied. For example:</p>
<pre><code>0.1234E00 is 0.1234
0.1234E02 is 12.34
0.1234E-1 is 0.01234</code></pre>
<p>This is an abomination which obscures the comparison of related
quantities; tables of means or of analyses of variance become very
difficult to read. It is acceptable as a default when a value is
unexpectedly very much larger or smaller than its companions, but its
appearance as standard output denotes either lazy programming or failure
to use good software properly. Like avoidance of ‘E’, neat arrangement
of output values in columns, with decimal points on a vertical line,
requires extra effort by a programmer but should be almost mandatory for
any software that is to be used often.</p>
</blockquote>
<p>One recommendation for improving the display of tables of numbers is
to round numbers to 2 <span class="citation">(Wainer 1997)</span> or 3
<span class="citation">Clark (1965)</span> digits for the following
reasons:</p>
<ol style="list-style-type: decimal">
<li>We cannot <em>comprehend</em> more than three digits very
easily.</li>
<li>We seldom <em>care</em> about accuracy of more than three
digits.</li>
<li>We can rarely <em>justify</em> more than three digits of accuracy
statistically.</li>
</ol>
<p>An alternative to significant digits is the concept of <em>effective
digits</em> <span class="citation">Kozak et al. (2011)</span>, which
considers the amount of variation in the data.</p>
<p>In R, the <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">round()</a></code> and <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif()</a></code> functions
can be used to round to 3 digits of accuracy, but those functions can
still print results in scientific notation and leave much to be desired.
The <code>lucid</code> package provides functions to improve the
presentation of floating point numbers in a clear (or lucid) way that
makes interpretation of the numbers immediately apparent.</p>
<p>Consider the following vector of coefficients from a fitted
model:</p>
<pre><code><span><span class="co">##                    effect</span></span>
<span><span class="co">## (Intercept)  1.135000e+02</span></span>
<span><span class="co">## A           -1.350000e+01</span></span>
<span><span class="co">## B            4.500000e+00</span></span>
<span><span class="co">## C            2.450000e+01</span></span>
<span><span class="co">## C1           6.927792e-14</span></span>
<span><span class="co">## C2          -1.750000e+00</span></span>
<span><span class="co">## D            1.650000e+01</span></span></code></pre>
<p>Questions of interest about the coefficients might include:</p>
<ol style="list-style-type: decimal">
<li>Which coefficient is zero?</li>
<li>How large is the intercept?</li>
</ol>
<p>Both questions can be answered using the output shown above, but it
takes too much effort to answer the questions. Now examine the same
vector of coefficients with prettier formatting:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://kwstat.github.io/lucid/" class="external-link">"lucid"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">7</span><span class="op">)</span> <span class="co"># knitr defaults to 4, R console uses 7</span></span>
<span><span class="fu"><a href="../reference/lucid.html">lucid</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             effect</span></span>
<span><span class="co">## (Intercept) 114   </span></span>
<span><span class="co">## A           -13.5 </span></span>
<span><span class="co">## B             4.5 </span></span>
<span><span class="co">## C            24.5 </span></span>
<span><span class="co">## C1            0   </span></span>
<span><span class="co">## C2           -1.75</span></span>
<span><span class="co">## D            16.5</span></span></code></pre>
<p>Which coefficient is zero? How large is the intercept?</p>
<p>Printing the numbers with the <code><a href="../reference/lucid.html">lucid()</a></code> function has made
the questions much easier to answer.</p>
<p>The sequence of steps used by <code><a href="../reference/lucid.html">lucid()</a></code> to format and
print the output is.</p>
<ol style="list-style-type: decimal">
<li>Zap small numbers to zero using <code><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall()</a></code>.</li>
<li>Round using 3 significant digits (user controllable option).</li>
<li>Drop trailing zeros.</li>
<li>Align numbers at the decimal point (text format).</li>
</ol>
<p>The <code>lucid</code> package contains a generic function
<code><a href="../reference/lucid.html">lucid()</a></code> with specific methods for numeric vectors, data
frames, and lists. The method for data frames applies formatting to each
numeric column and leaves other columns unchanged. The
<code><a href="../reference/lucid.html">lucid()</a></code> function is primarily a <em>formatting</em>
function, the results of which are passed to the regular
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> functions.</p>
</div>
<div class="section level3">
<h3 id="example-antibiotic-effectiveness">Example: Antibiotic effectiveness<a class="anchor" aria-label="anchor" href="#example-antibiotic-effectiveness"></a>
</h3>
<p><span class="citation">Wainer and Larsen (2009)</span> present data
published by Will Burtin in 1951 on the effectiveness of antibiotics
against 16 types of bacteria. The data is included in the
<code>lucid</code> package as a dataframe called
<code>antibiotic</code>. The default view of this data is:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">antibiotic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      bacteria penicillin streptomycin neomycin gramstain</span></span>
<span><span class="co">## 1        Aerobacter aerogenes    870.000         1.00    1.600       neg</span></span>
<span><span class="co">## 2            Brucella abortus      1.000         2.00    0.020       neg</span></span>
<span><span class="co">## 3            Escherichia coli    100.000         0.40    0.100       neg</span></span>
<span><span class="co">## 4       Klebsiella pneumoniae    850.000         1.20    1.000       neg</span></span>
<span><span class="co">## 5  Mycobacterium tuberculosis    800.000         5.00    2.000       neg</span></span>
<span><span class="co">## 6            Proteus vulgaris      3.000         0.10    0.100       neg</span></span>
<span><span class="co">## 7      Pseudomonas aeruginosa    850.000         2.00    0.400       neg</span></span>
<span><span class="co">## 8          Salmonella typhosa      1.000         0.40    0.008       neg</span></span>
<span><span class="co">## 9   Salmonella schottmuelleri     10.000         0.80    0.090       neg</span></span>
<span><span class="co">## 10         Bacillis anthracis      0.001         0.01    0.007       pos</span></span>
<span><span class="co">## 11     Diplococcus pneumoniae      0.005        11.00   10.000       pos</span></span>
<span><span class="co">## 12       Staphylococcus albus      0.007         0.10    0.001       pos</span></span>
<span><span class="co">## 13      Staphylococcus aureus      0.030         0.03    0.001       pos</span></span>
<span><span class="co">## 14      Streptococcus fecalis      1.000         1.00    0.100       pos</span></span>
<span><span class="co">## 15  Streptococcus hemolyticus      0.001        14.00   10.000       pos</span></span>
<span><span class="co">## 16     Streptococcus viridans      0.005        10.00   40.000       pos</span></span></code></pre>
<p>Due to the wide range in magnitude of the values, nearly half of the
floating-point numbers in the default view contain trailing zeros after
the decimal, which adds significant clutter and impedes interpretation.
The <code><a href="../reference/lucid.html">lucid()</a></code> display of the data is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lucid.html">lucid</a></span><span class="op">(</span><span class="va">antibiotic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      bacteria penicillin streptomycin neomycin gramstain</span></span>
<span><span class="co">## 1        Aerobacter aerogenes    870             1       1.6         neg</span></span>
<span><span class="co">## 2            Brucella abortus      1             2       0.02        neg</span></span>
<span><span class="co">## 3            Escherichia coli    100             0.4     0.1         neg</span></span>
<span><span class="co">## 4       Klebsiella pneumoniae    850             1.2     1           neg</span></span>
<span><span class="co">## 5  Mycobacterium tuberculosis    800             5       2           neg</span></span>
<span><span class="co">## 6            Proteus vulgaris      3             0.1     0.1         neg</span></span>
<span><span class="co">## 7      Pseudomonas aeruginosa    850             2       0.4         neg</span></span>
<span><span class="co">## 8          Salmonella typhosa      1             0.4     0.008       neg</span></span>
<span><span class="co">## 9   Salmonella schottmuelleri     10             0.8     0.09        neg</span></span>
<span><span class="co">## 10         Bacillis anthracis      0.001         0.01    0.007       pos</span></span>
<span><span class="co">## 11     Diplococcus pneumoniae      0.005        11      10           pos</span></span>
<span><span class="co">## 12       Staphylococcus albus      0.007         0.1     0.001       pos</span></span>
<span><span class="co">## 13      Staphylococcus aureus      0.03          0.03    0.001       pos</span></span>
<span><span class="co">## 14      Streptococcus fecalis      1             1       0.1         pos</span></span>
<span><span class="co">## 15  Streptococcus hemolyticus      0.001        14      10           pos</span></span>
<span><span class="co">## 16     Streptococcus viridans      0.005        10      40           pos</span></span></code></pre>
<p>The <code><a href="../reference/lucid.html">lucid()</a></code> display is dramatically simplified,
providing a clear picture of the effectiveness of the antibiotics
against bacteria. This view of the data matches exactly the appearance
of Table 1 in <span class="citation">Wainer and Larsen
(2009)</span>.</p>
<p>A stem-and-leaf plot is a semi-graphical display of data, in that the
<em>positions</em> of the numbers create a display similar to a
histogram. In a similar manner, the <code><a href="../reference/lucid.html">lucid()</a></code> output is a
semi-graphical view of the data. The figure below shows a dotplot of the
penicillin values on a reverse log10 scale. The values are also shown
along the right axis in <code><a href="../reference/lucid.html">lucid()</a></code> format. Note the similarity
in the overall shape of the dots and the positions of the left-most
significant digit in the numerical values along the right axis.</p>
<p><img src="lucid_examples_files/figure-html/dotplot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="example-using-lucid-with-broom">Example: Using <code>lucid</code> with <code>broom</code><a class="anchor" aria-label="anchor" href="#example-using-lucid-with-broom"></a>
</h3>
<p>The <code>broom</code> package by <span class="citation">Robinson
(2016)</span> can be used to collect statistics from fitted models into
tidy data frames. For example, using the <code>Orange</code> tree data,
it is possible to fit a separate regression line for each tree. (The
straight-line regression here is not entirely sensible, but illustrates
a point.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: dplyr</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: broom</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Orange</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">circumference</span> <span class="op">~</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   Tree [5]</span></span></span>
<span><span class="co">##    Tree  term        estimate std.error statistic   p.value</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 3     (Intercept)  19.2      5.86         3.28 0.022<span style="text-decoration: underline;">1</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 3     age           0.081<span style="text-decoration: underline;">1</span>   0.005<span style="text-decoration: underline;">63</span>     14.4  0.000<span style="text-decoration: underline;">029</span>0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 1     (Intercept)  24.4      6.54         3.73 0.013<span style="text-decoration: underline;">5</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 1     age           0.081<span style="text-decoration: underline;">5</span>   0.006<span style="text-decoration: underline;">28</span>     13.0  0.000<span style="text-decoration: underline;">048</span>5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 5     (Intercept)   8.76     8.18         1.07 0.333    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 5     age           0.111    0.007<span style="text-decoration: underline;">85</span>     14.1  0.000<span style="text-decoration: underline;">031</span>8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 2     (Intercept)  20.0      9.35         2.13 0.085<span style="text-decoration: underline;">9</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 2     age           0.125    0.008<span style="text-decoration: underline;">98</span>     13.9  0.000<span style="text-decoration: underline;">034</span>3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 4     (Intercept)  14.6     11.2          1.30 0.249    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 4     age           0.135    0.010<span style="text-decoration: underline;">8</span>      12.5  0.000<span style="text-decoration: underline;">057</span>3</span></span></code></pre>
<p>Extracting information from the sea of numbers above is difficult.
The <code>lucid</code> function comes to the rescue, simply by adding
one more step to the sequence of pipes.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Orange</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">circumference</span> <span class="op">~</span>  <span class="va">age</span>, data<span class="op">=</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">lucid</span></span></code></pre></div>
<pre><code><span><span class="co">##    Tree        term estimate std.error statistic   p.value</span></span>
<span><span class="co">## 1     3 (Intercept)  19.2      5.86         3.28 0.0221   </span></span>
<span><span class="co">## 2     3         age   0.0811   0.00563     14.4  0.000029 </span></span>
<span><span class="co">## 3     1 (Intercept)  24.4      6.54         3.73 0.0135   </span></span>
<span><span class="co">## 4     1         age   0.0815   0.00628     13    0.0000485</span></span>
<span><span class="co">## 5     5 (Intercept)   8.76     8.18         1.07 0.333    </span></span>
<span><span class="co">## 6     5         age   0.111    0.00785     14.1  0.0000318</span></span>
<span><span class="co">## 7     2 (Intercept)  20        9.35         2.13 0.0859   </span></span>
<span><span class="co">## 8     2         age   0.125    0.00898     13.9  0.0000343</span></span>
<span><span class="co">## 9     4 (Intercept)  14.6     11.2          1.3  0.249    </span></span>
<span><span class="co">## 10    4         age   0.135    0.0108      12.5  0.0000573</span></span></code></pre>
<p>After formatting, information in the table almost jumps out at the
reader, reducing the amount of cognitive effort needed for
interpretation.</p>
</div>
<div class="section level3">
<h3 id="example-application-to-mixed-models">Example: Application to mixed models<a class="anchor" aria-label="anchor" href="#example-application-to-mixed-models"></a>
</h3>
<p>During the process of iterative fitting of mixed models, it is often
useful to compare fits of different models to data, for example using
loglikelihood or AIC values, or with the help of residual plots. It can
also be very informative to inspect the estimated values of variance
components.</p>
<p>To that end, the generic <code><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr()</a></code> function found in the
<code>nlme</code> <span class="citation">Pinheiro et al. (2014)</span>
and <code>lme4</code> <span class="citation">Bates et al. (2014)</span>
packages can be used to print variance estimates from fitted models. The
<code><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr()</a></code> function is not available for models obtained
using the <code>asreml</code> <span class="citation">Butler
(2009)</span> package.</p>
<p>The <code>lucid</code> package provides a generic function called
<code><a href="../reference/vc.html">vc()</a></code> that provides a unified interface for extracting the
variance components from fitted models obtained from the
<code>asreml</code>, <code>lme4</code>, <code>nlme</code>, and
<code>rjags</code> packages. The <code><a href="../reference/vc.html">vc()</a></code> function has methods
specific to each package that make it easy to extract the estimated
variances and correlations from fitted models and formats the results
using the <code><a href="../reference/lucid.html">lucid()</a></code> function.</p>
<p><span class="citation">Pearce et al. (1988)</span> suggest showing
four significant digits for the error mean square and two decimal places
digits for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
values. The <code><a href="../reference/lucid.html">lucid()</a></code> function uses a similar philosophy,
presenting the variances with four significant digits and
<code>asreml</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
statistics with two significant digits.</p>
<div class="section level4">
<h4 id="vc-example-1---rail-data">vc() example 1 - Rail data<a class="anchor" aria-label="anchor" href="#vc-example-1---rail-data"></a>
</h4>
<p>The following simple example illustrates use of the <code><a href="../reference/vc.html">vc()</a></code>
function for identical REML models in the <code>nlme</code>,
<code>lme4</code>, and <code>asreml</code> packages. The travel times of
ultrasonic waves in six steel rails was modeled as an overall mean, a
random effect for each rail, and a random residual. The package
<code>rjags</code> is used to fit a similar Bayesian model inspired by
<span class="citation">Wilkinson (2014)</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="nlme">nlme<a class="anchor" aria-label="anchor" href="#nlme"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">"nlme"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: nlme</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'nlme'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     collapse</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rail</span><span class="op">)</span></span>
<span><span class="va">mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span><span class="va">travel</span><span class="op">~</span><span class="fl">1</span>, random<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">Rail</span>, data<span class="op">=</span><span class="va">Rail</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vc.html">vc</a></span><span class="op">(</span><span class="va">mn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       effect variance stddev</span></span>
<span><span class="co">##  (Intercept)   615.3  24.81 </span></span>
<span><span class="co">##     Residual    16.17  4.021</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="lme4">lme4<a class="anchor" aria-label="anchor" href="#lme4"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/" class="external-link">"lme4"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: lme4</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'lme4'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:nlme':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     lmList</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">travel</span><span class="op">~</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Rail</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Rail</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vc.html">vc</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       grp        var1 var2   vcov  sdcor</span></span>
<span><span class="co">##      Rail (Intercept) &lt;NA&gt; 615.3  24.81 </span></span>
<span><span class="co">##  Residual        &lt;NA&gt; &lt;NA&gt;  16.17  4.021</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="asreml">asreml<a class="anchor" aria-label="anchor" href="#asreml"></a>
</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># require("asreml")</span></span>
<span><span class="co"># ma &lt;- asreml(travel~1, random=~Rail, data=Rail)</span></span>
<span><span class="co"># vc(ma)</span></span>
<span><span class="co">##         effect component std.error z.ratio constr</span></span>
<span><span class="co">##  Rail!Rail.var    615.3      392.6     1.6    pos</span></span>
<span><span class="co">##     R!variance     16.17       6.6     2.4    pos</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="jags">JAGS<a class="anchor" aria-label="anchor" href="#jags"></a>
</h2>
<p>In a Bayesian model all effects can be considered as random.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">"nlme"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rail</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://mcmc-jags.sourceforge.io" class="external-link">"rjags"</a></span><span class="op">)</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span></span>
<span><span class="st">"model {</span></span>
<span><span class="st">for(i in 1:nobs){</span></span>
<span><span class="st">  travel[i] ~ dnorm(mu + theta[Rail[i]], tau)</span></span>
<span><span class="st">}</span></span>
<span><span class="st">for(j in 1:6) {</span></span>
<span><span class="st">  theta[j] ~ dnorm(0, tau.theta)</span></span>
<span><span class="st">}</span></span>
<span><span class="st">mu ~ dnorm(50, 0.0001) # Overall mean. dgamma() </span></span>
<span><span class="st">tau ~ dgamma(1, .001)</span></span>
<span><span class="st">tau.theta ~ dgamma(1, .001)</span></span>
<span><span class="st">residual &lt;- 1/sqrt(tau)</span></span>
<span><span class="st">sigma.rail &lt;- 1/sqrt(tau.theta)</span></span>
<span><span class="st">}"</span></span>
<span><span class="va">jdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nobs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Rail</span><span class="op">)</span>, travel<span class="op">=</span><span class="va">Rail</span><span class="op">$</span><span class="va">travel</span>, Rail<span class="op">=</span><span class="va">Rail</span><span class="op">$</span><span class="va">Rail</span><span class="op">)</span></span>
<span><span class="va">jinit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu<span class="op">=</span><span class="fl">50</span>, tau<span class="op">=</span><span class="fl">1</span>, tau.theta<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tc5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/textconnections.html" class="external-link">textConnection</a></span><span class="op">(</span><span class="va">m5</span><span class="op">)</span></span>
<span><span class="va">j5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">jags.model</a></span><span class="op">(</span><span class="va">tc5</span>, data<span class="op">=</span><span class="va">jdat</span>, inits<span class="op">=</span><span class="va">jinit</span>, n.chains<span class="op">=</span><span class="fl">2</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">tc5</span><span class="op">)</span></span>
<span><span class="va">c5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rjags/man/coda.samples.html" class="external-link">coda.samples</a></span><span class="op">(</span><span class="va">j5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>,<span class="st">"theta"</span>, <span class="st">"residual"</span>, <span class="st">"sigma.rail"</span><span class="op">)</span>, </span>
<span>                   n.iter<span class="op">=</span><span class="fl">100000</span>, thin<span class="op">=</span><span class="fl">5</span>, progress.bar<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p>Compare the JAGS point estimates and quantiles (above) with the
results from <code>lme4</code> below.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">## Formula: travel ~ 1 + (1 | Rail)</span></span>
<span><span class="co">##    Data: Rail</span></span>
<span><span class="co">## REML criterion at convergence: 122.177</span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Std.Dev.</span></span>
<span><span class="co">##  Rail     (Intercept) 24.805  </span></span>
<span><span class="co">##  Residual              4.021  </span></span>
<span><span class="co">## Number of obs: 18, groups:  Rail, 6</span></span>
<span><span class="co">## Fixed Effects:</span></span>
<span><span class="co">## (Intercept)  </span></span>
<span><span class="co">##        66.5</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html" class="external-link">ranef</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $Rail</span></span>
<span><span class="co">##   (Intercept)</span></span>
<span><span class="co">## 2   -34.53091</span></span>
<span><span class="co">## 5   -16.35675</span></span>
<span><span class="co">## 1   -12.39148</span></span>
<span><span class="co">## 6    16.02631</span></span>
<span><span class="co">## 3    18.00894</span></span>
<span><span class="co">## 4    29.24388</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## with conditional variances for "Rail"</span></span></code></pre>
<p>While the <code><a href="../reference/lucid.html">lucid()</a></code> function is primarily a formatting
function and uses the standard <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> functions in R, the
<code><a href="../reference/vc.html">vc()</a></code> function defines an additional class for the value of
the function and has dedicated <code>print</code> methods for the class.
This was done to allow additional formatting of the results.</p>
<div class="section level4">
<h4 id="vc-example-2---analysis-of-federer-diagcheck-data">vc() example 2 - Analysis of federer.diagcheck data<a class="anchor" aria-label="anchor" href="#vc-example-2---analysis-of-federer-diagcheck-data"></a>
</h4>
<p>The second, more complex example is based on a model in <span class="citation">Federer and Wolfinger (2003)</span> in which orthogonal
polynomials are used to model trends along the rows and columns of a
field experiment. The data are available in the <code>agridat</code>
package <span class="citation">(Wright 2014)</span> as the
<code>federer.diagcheck</code> data frame. The help page for that data
shows how to reproduce the analysis of <span class="citation">Federer
and Wolfinger (2003)</span>. When using the <code>lme4</code> package to
reproduce the analysis, two different optimizers are available. Do the
two different optimizers lead to similar estimated variances?</p>
<p>In the output below, the first column identifies terms in the model,
the next two columns are the variance and standard deviation from the
‘bobyqa’ optimizer, while the final two columns are from the
‘NelderMead’ optimizer. Note, these results are from <code>lme4</code>
version 1.1-7 and are likely to be different than the results from more
recent versions of <code>lme4</code>.</p>
<p>The default output printing is shown first.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           term     vcov-bo  sdcor-bo sep      vcov-ne     sdcor-ne</span></span>
<span><span class="co">## 1  (Intercept)   2869.4469  53.56722     3.228419e+03  56.81917727</span></span>
<span><span class="co">## 2        r1:c3   5531.5724  74.37454     7.688139e+03  87.68203447</span></span>
<span><span class="co">## 3        r1:c2  58225.7678 241.30016     6.974755e+04 264.09761622</span></span>
<span><span class="co">## 4        r1:c1 128004.1561 357.77668     1.074270e+05 327.76064925</span></span>
<span><span class="co">## 5           c8   6455.7495  80.34768     6.787004e+03  82.38327224</span></span>
<span><span class="co">## 6           c6   1399.7294  37.41296     1.636128e+03  40.44907560</span></span>
<span><span class="co">## 7           c4   1791.6507  42.32790     1.226846e+04 110.76308194</span></span>
<span><span class="co">## 8           c3   2548.8847  50.48648     2.686302e+03  51.82954364</span></span>
<span><span class="co">## 9           c2   5941.7908  77.08301     7.644730e+03  87.43414634</span></span>
<span><span class="co">## 10          c1      0.0000   0.00000     1.225143e-03   0.03500204</span></span>
<span><span class="co">## 11         r10   1132.9501  33.65932     1.975505e+03  44.44665149</span></span>
<span><span class="co">## 12          r8   1355.2291  36.81344     1.241429e+03  35.23391157</span></span>
<span><span class="co">## 13          r4   2268.7296  47.63118     2.811241e+03  53.02113582</span></span>
<span><span class="co">## 14          r2    241.7894  15.54958     9.282275e+02  30.46682578</span></span>
<span><span class="co">## 15          r1   9199.9022  95.91612     1.036358e+04 101.80169429</span></span>
<span><span class="co">## 16        &lt;NA&gt;   4412.1096  66.42371     4.126832e+03  64.24042100</span></span></code></pre>
<p>How similar are the variance estimates obtained from the two
optimization methods? It is difficult to compare the results due to the
clutter of extra digits, and because of some quirks in the way R formats
the output. The variances in column 2 are shown in non-scientific
format, while the variances in column 5 are shown in scientific format.
The standard deviations are shown with 5 decimal places in column 3 and
8 decimal places in column 6. (All numbers were stored with 15 digits of
precision.)</p>
<p>The <code><a href="../reference/lucid.html">lucid()</a></code> function is now used to show the results in
the manner of the <code><a href="../reference/vc.html">vc()</a></code> function.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lucid.html">lucid</a></span><span class="op">(</span><span class="va">out</span>, dig<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           term  vcov-bo sdcor-bo sep  vcov-ne sdcor-ne</span></span>
<span><span class="co">## 1  (Intercept)   2869      53.57       3228     56.82 </span></span>
<span><span class="co">## 2        r1:c3   5532      74.37       7688     87.68 </span></span>
<span><span class="co">## 3        r1:c2  58230     241.3       69750    264.1  </span></span>
<span><span class="co">## 4        r1:c1 128000     357.8      107400    327.8  </span></span>
<span><span class="co">## 5           c8   6456      80.35       6787     82.38 </span></span>
<span><span class="co">## 6           c6   1400      37.41       1636     40.45 </span></span>
<span><span class="co">## 7           c4   1792      42.33      12270    110.8  </span></span>
<span><span class="co">## 8           c3   2549      50.49       2686     51.83 </span></span>
<span><span class="co">## 9           c2   5942      77.08       7645     87.43 </span></span>
<span><span class="co">## 10          c1      0       0             0      0.035</span></span>
<span><span class="co">## 11         r10   1133      33.66       1976     44.45 </span></span>
<span><span class="co">## 12          r8   1355      36.81       1241     35.23 </span></span>
<span><span class="co">## 13          r4   2269      47.63       2811     53.02 </span></span>
<span><span class="co">## 14          r2    241.8    15.55        928.2   30.47 </span></span>
<span><span class="co">## 15          r1   9200      95.92      10360    101.8  </span></span>
<span><span class="co">## 16        &lt;NA&gt;   4412      66.42       4127     64.24</span></span></code></pre>
<p>The formatting of the variance columns is consistent as is the
formatting of the standard deviation columns. Fewer digits are shown. It
is easy to compare the columns and see that the two optimizers are
giving quite different answers. Note: The Bobyqa results are almost
identical to the results obtained when using ASREML or SAS.</p>
<p>Note: Data frames have no quotes, but numeric matrices are printed
with quotes. Use <code><a href="https://rdrr.io/r/base/noquote.html" class="external-link">noquote()</a></code> to print without quotes, for
example:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/noquote.html" class="external-link">noquote</a></span><span class="op">(</span><span class="fu"><a href="../reference/lucid.html">lucid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   mpg cyl disp hp  drat wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4         21  6   160  110 3.9  2.6 16   0  1  4    4   </span></span>
<span><span class="co">## Mazda RX4 Wag     21  6   160  110 3.9  2.9 17   0  1  4    4   </span></span>
<span><span class="co">## Datsun 710        23  4   110   93 3.8  2.3 19   1  1  4    1   </span></span>
<span><span class="co">## Hornet 4 Drive    21  6   260  110 3.1  3.2 19   1  0  3    1   </span></span>
<span><span class="co">## Hornet Sportabout 19  8   360  180 3.2  3.4 17   0  0  3    2   </span></span>
<span><span class="co">## Valiant           18  6   220  100 2.8  3.5 20   1  0  3    1</span></span></code></pre>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bates2014lme4" class="csl-entry">
Bates, Douglas, Martin Maechler, Ben Bolker, and S. Walker. 2014.
<em><span class="nocase">lme4: Linear mixed-effects models using Eigen
and S4</span></em>. <a href="https://CRAN.R-project.org/package=lme4" class="external-link">https://CRAN.R-project.org/package=lme4</a>.
</div>
<div id="ref-butler2009asreml" class="csl-entry">
Butler, David. 2009. <em><span class="nocase">asreml: asreml() fits the
linear mixed model</span></em>. <a href="https://www.vsni.co.uk" class="external-link">www.vsni.co.uk</a>.
</div>
<div id="ref-clark1965presentation" class="csl-entry">
Clark, R. T. 1965. <span>“The Presentation of Numerical Results of
Experiments for Publication in a Scientific Agricultural
Journal.”</span> <em>Experimental Agriculture</em> 1: 315–19. <a href="https://doi.org/10.1017/S001447970002161X" class="external-link">https://doi.org/10.1017/S001447970002161X</a>.
</div>
<div id="ref-ehrenberg1977rudiments" class="csl-entry">
Ehrenberg, A. S. C. 1977. <span>“Rudiments of Numeracy.”</span>
<em>Journal of the Royal Statistical Society. Series A</em>, 277–97. <a href="https://doi.org/10.2307/2344922" class="external-link">https://doi.org/10.2307/2344922</a>.
</div>
<div id="ref-farquhar1891economic" class="csl-entry">
Farquhar, Arthur B., and Henry Farquhar. 1891. <em>Economic and
Industrial Delusions</em>. New York: G. P. Putnam’s Sons. <a href="https://books.google.com/books?id=BHkpAAAAYAAJ" class="external-link">https://books.google.com/books?id=BHkpAAAAYAAJ</a>.
</div>
<div id="ref-federer2003proc" class="csl-entry">
Federer, Walter T., and Russell D. Wolfinger. 2003. <span>“Handbook of
Formulas and Software for Plant Geneticists and Breeders.”</span> In,
edited by Manjit Kang. Haworth Press.
</div>
<div id="ref-feinberg2011extracting" class="csl-entry">
Feinberg, Richard A., and Howard Wainer. 2011. <span>“Extracting
Sunbeams from Cucumbers.”</span> <em>Journal of Computational and
Graphical Statistics</em> 20 (4): 793–810. <a href="https://doi.org/10.1198/jcgs.2011.204a" class="external-link">https://doi.org/10.1198/jcgs.2011.204a</a>.
</div>
<div id="ref-finney1988data" class="csl-entry">
Finney, D. J. 1988. <span>“Was This in Your Statistics Textbook?
<span>II</span>. <span>Data</span> Handling.”</span> <em>Experimental
Agriculture</em> 24: 343–53. <a href="https://doi.org/10.1017/S0014479700016197" class="external-link">https://doi.org/10.1017/S0014479700016197</a>.
</div>
<div id="ref-kozak2011reporting" class="csl-entry">
Kozak, Marcin, Ricardo Antunes Azevedo, Justyna Jupowicz-Kozak, and
Wojtek Krzanowski. 2011. <span>“Reporting Numbers in Agriculture and
Biology: Don’t Overdo the Digits.”</span> <em>Australian Journal of Crop
Science</em> 5: 1876–81. <a href="http://www.cropj.com/kozak_5_13_2011_1876_1881.pdf" class="external-link">http://www.cropj.com/kozak_5_13_2011_1876_1881.pdf</a>.
</div>
<div id="ref-pearce1988manual" class="csl-entry">
Pearce, S. C., G. M. Clarke, G. V. Dyke, and R. E. Kempson. 1988. <em>A
Manual of Crop Experimentation</em>. Charles Griffin; Company.
</div>
<div id="ref-pinheiro2014nlme" class="csl-entry">
Pinheiro, Jose, Douglas Bates, Saikat DebRoy, Deepayan Sarkar, and R
Core Team. 2014. <em><span class="nocase">nlme</span>: Linear and
Nonlinear Mixed Effects Models</em>. <a href="https://CRAN.R-project.org/package=nlme" class="external-link">https://CRAN.R-project.org/package=nlme</a>.
</div>
<div id="ref-robinson2016broom" class="csl-entry">
Robinson, David. 2016. <em><span class="nocase">broom: Convert
Statistical Analysis Objects into Tidy Data Frames</span></em>. <a href="https://CRAN.R-project.org/package=broom" class="external-link">https://CRAN.R-project.org/package=broom</a>.
</div>
<div id="ref-wainer1997improving" class="csl-entry">
Wainer, Howard. 1997. <span>“Improving Tabular Displays, with
<span>NAEP</span> Tables as Examples and Inspirations.”</span>
<em>Journal of Educational and Behavioral Statistics</em> 22: 1–30. <a href="https://doi.org/10.3102/10769986022001001" class="external-link">https://doi.org/10.3102/10769986022001001</a>.
</div>
<div id="ref-wainer2009pictures" class="csl-entry">
Wainer, Howard, and Mike Larsen. 2009. <span>“Pictures at an
Exhibition.”</span> <em>Chance</em> 22 (2): 46–54. <a href="https://doi.org/10.1080/09332480.2009.10722958" class="external-link">https://doi.org/10.1080/09332480.2009.10722958</a>.
</div>
<div id="ref-wilkinson2014oneway" class="csl-entry">
Wilkinson, Darren. 2014. <span>“One-Way ANOVA with Fixed and Random
Effects from a Bayesian Perspective.”</span> <a href="https://darrenjw.wordpress.com/2014/12/22/one-way-anova-with-fixed-and-random-effects-from-a-bayesian-perspective/" class="external-link">https://darrenjw.wordpress.com/2014/12/22/one-way-anova-with-fixed-and-random-effects-from-a-bayesian-perspective/</a>.
</div>
<div id="ref-wright2014agridat" class="csl-entry">
Wright, Kevin. 2014. <em>Agridat: Agricultural Datasets</em>. <a href="https://CRAN.R-project.org/package=agridat" class="external-link">https://CRAN.R-project.org/package=agridat</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
